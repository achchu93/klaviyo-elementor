!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o=elementorModules.editor.utils.Module.extend({elementType:null,__construct:function(e){this.elementType=e,this.addEditorListener()},addEditorListener:function(){var e=this;if(e.onElementChange){var t="change";"global"!==e.elementType&&(t+=":"+e.elementType),elementor.channels.editor.on(t,(function(t,n){e.onElementChange(t.model.get("name"),t,n)}))}},addControlSpinner:function(e){var t=this.getEditorControlView(e).$el,n=t.find(":input");n.attr("disabled")||(n.attr("disabled",!0),t.find(".elementor-control-title").after('<span class="elementor-control-spinner"><i class="eicon-spinner eicon-animation-spin"></i>&nbsp;</span>'))},removeControlSpinner:function(e){var t=this.getEditorControlView(e).$el;t.find(":input").attr("disabled",!1),t.find("elementor-control-spinner").remove()},addSectionListener:function(e,t){var n=this;elementor.channels.editor.on("section:activated",(function(o,i){var r=i.getOption("editedElementView").getEditModel(),a=r.get("elType"),l=arguments;"widget"===a&&(a=r.get("widgetType")),n.elementType===a&&e===o&&setTimeout((function(){t.apply(n,l)}),10)}))}}),i=o.extend({__construct:function(){this.cache={},o.prototype.__construct.apply(this,arguments)},getName:function(){return""},getCacheKey:function(e){return JSON.stringify({service:this.getName(),data:e})},fetchCache:function(e,t,n){var o=this;return elementorPro.ajax.addRequest("forms_panel_action_data",{unique_id:"integrations_"+this.getName(),data:n,success:function(n){o.cache[e]=_.extend({},o.cache[e]),o.cache[e][t]=n[e]}})},updateOptions:function(e,t){var n=this.getEditorControlView(e);n&&(this.getEditorControlModel(e).set("options",t),n.render())},onInit:function(){this.addSectionListener("section_"+this.getName(),this.onSectionActive)},onSectionActive:function(){this.onApiUpdate()},onApiUpdate:function(){}}),r=i.extend({getName:function(){return"klaviyowp"},onElementChange:function(e){["klaviyo_api_key_source","klaviyo_api_key"].includes(e)&&this.onApiUpdate()},onApiUpdate:function(){var e=this,t=e.getEditorControlView("klaviyo_api_key"),n=e.getEditorControlView("klaviyo_api_key_source");if("default"!==n.getControlValue()&&""===t.getControlValue())return e.updateOptions("klaviyo_list",[]),void e.getEditorControlView("klaviyo_list").setValue("");e.addControlSpinner("klaviyo_list");var o=this.getCacheKey({type:"lists",controls:[t.getControlValue(),n.getControlValue()]});e.getKlaviyoCache("lists","lists",o).done((function(t){e.updateOptions("klaviyo_list",t.lists)}))},getKlaviyoCache:function(e,t,n,o){if(_.has(this.cache[e],n)){var i={};return i[e]=this.cache[e][n],jQuery.Deferred().resolve(i)}return o=_.extend({},o,{service:"klaviyowp",klaviyo_action:t,api_key:this.getEditorControlView("klaviyo_api_key").getControlValue(),use_global_api_key:this.getEditorControlView("klaviyo_api_key_source").getControlValue()}),this.fetchCache(e,n,o)},onSectionActive:function(){i.prototype.onSectionActive.apply(this,arguments),this.onApiUpdate()}}),a=Marionette.Application.extend({onStart:function(){jQuery(window).on("elementor:init",this.onElementorInit)},onElementorInit:function(){elementor.debug.addURLToWatch("klaviyo-elementor/dist"),elementorPro.modules.forms=new r("form")}});window.klaviyowp=new a,klaviyowp.start()}]);